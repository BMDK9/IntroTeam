<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I-WORLD</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <style>
        .d-flex>a { 
            border-radius: 5px 0px 0px 5px;
            padding: 5px;
            
            background-color: lightgray;
        }
        .search-icon {
            width: 30px;
            height: 30px;
        }

        .form-control {
            width: 200px;
            border-radius: 0px 5px 5px 0px;
        }
    </style>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";


        // Firebase 구성 정보 설정
        const firebaseConfig = {
            apiKey: "AIzaSyAzXX5j6y95F5-w-aemZc--QymtiWT_UVM",
            authDomain: "intro-team-42d34.firebaseapp.com",
            projectId: "intro-team-42d34",
            storageBucket: "intro-team-42d34.appspot.com",
            messagingSenderId: "367458824490",
            appId: "1:367458824490:web:b05f0947f7149006206e53",
            measurementId: "G-0488K83Q4K"
        };


        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);







        async function getSearchResult() { // db에 검색결과가 있는지 확인하여 그에 따른 결과를 보여주는 함수
            searchWord = $('#search').val();

            let searchData = await getDocs(
                query(
                    collection(db, "member"),
                    where('name', '==', searchWord))
            );

            if (searchData.empty) {
                alert(`${searchWord} 에 대한 검색 결과를 찾을 수 없습니다.`);
            } else {
                searchData.forEach((data) => {
                    let result = data.data();
                    let memberId = data.id;

                    if (memberId == 0)
                        location.href = '0.html'; // 김성훈님
                    if (memberId == 1)
                        location.href = '1.html'; // 김민선님
                    if (memberId == 2)
                        location.href = '2.html'; // 유민아
                    if (memberId == 3)
                        location.href = '3.html'; // 이예진님
                })
            }
        }

        let searchWord = '';
        $('#search').keydown(function (e) { // enter 눌렀을 때 검색어 가져와서 전달
            if (e.keyCode == 13) {
                e.preventDefault();
                getSearchResult();
            }
        })

    </script>
</head>

<body>
    <form class="d-flex" role="search">
        <a><img class="search-icon" src="./image/search-icon.png"></a>
        <input id="search" class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
    </form>
</body>

</html>