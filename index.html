<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©”ì¸í˜ì´ì§€</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="./css/index.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script type="module">
        // Firebase SDK ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸°
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { doc, collection, addDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase êµ¬ì„± ì •ë³´ ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyAzXX5j6y95F5-w-aemZc--QymtiWT_UVM",
            authDomain: "intro-team-42d34.firebaseapp.com",
            projectId: "intro-team-42d34",
            storageBucket: "intro-team-42d34.appspot.com",
            messagingSenderId: "367458824490",
            appId: "1:367458824490:web:b05f0947f7149006206e53",
            measurementId: "G-0488K83Q4K"
        };


        // Firebase ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);







        async function getSearchResult() { // ê²€ìƒ‰ ê²°ê³¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
            searchWord = $('#search').val();

            if (searchWord == 'ê¹€ì„±í›ˆ')
                location.href = 'sunghun.html'; // ê¹€ì„±í›ˆë‹˜
            else if (searchWord == 'ê¹€ë¯¼ì„ ')
                location.href = '2.html'; // ê¹€ë¯¼ì„ ë‹˜
            else if (searchWord == 'ìœ ë¯¼ì•„')
                location.href = 'minahpage.html'; // ìœ ë¯¼ì•„
            else if (searchWord == 'ì´ì˜ˆì§„')
                location.href = 'yejinpage.html'; // ì´ì˜ˆì§„ë‹˜
            else
                alert(`${searchWord} ì— ëŒ€í•œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
        }

        let searchWord = '';
        $('#search').keydown(function (e) { // enter ëˆŒë €ì„ ë•Œ ê²€ìƒ‰ì–´ ê°€ì ¸ì™€ì„œ ì „ë‹¬
            if (e.keyCode == 13) {
                e.preventDefault();
                getSearchResult();
            }
        })
        //ì‚¬ì´ë“œíƒœê·¸
        $('#index').click(function () {
            location.href = 'index.html';
        }) //ë©”ì¸

        $('#sunghun').click(function () {
            location.href = 'sunghun.html';
        }) //ì„±í›ˆ

        $('#minsun').click(function () {
            location.href = 'minsunpage.html';
        }) //ë¯¼ì„ 

        $('#minah').click(function () {
            location.href = 'minahpage.html';
        }) //ë¯¼í•˜

        $('#yejin').click(function () {
            location.href = 'yejinpage.html';
        }) //ì˜ˆì§„

        $('#visitor').click(function () {
            location.href = 'visitorlog.html';
        }) //ë°©ëª…ë¡

        async function dataUpdate() {
            let boxes = $("input[type='checkbox']:checked");
            let checked = boxes.length;

            let getId = $('#sendbtn').on('click', '.checkbox', function () {
                let boxId = $(this).attr('id');
            })

            let update = { // ì—…ë°ì´íŠ¸í•  ë°ì´í„°
                'main': $(`#main`).is(':checked'),
                'personal': $('#personal').is(':checked'),
                'search': $(`#search-input`).is(':checked'),
                'achievement': $(`#achievement`).is(':checked'),
                'visitorBook': $(`#visitorBook`).is(':checked'),

                'count': checked
            };

            let dataPackage = await getDocs(collection(db, "goals"));
            dataPackage.forEach(async (data) => {
                console.log(data.id, update);
                await updateDoc(doc(db, "goals", data.id), update);
                window.location.reload();
            })
        }

        $('#sendbtn').click(async function () {
            dataUpdate();
        });


        $(document).ready(async function () {
            let getData = await getDocs(collection(db, "goals"));
            let temp;
            getData.forEach((doc) => {
                console.log("Current data: ", doc.data());
                let goal = doc.data();

                let main = goal['main'];
                let personal = goal['personal'];
                let searchInput = goal['search'];
                let achievement = goal['achievement'];
                let visitorBook = goal['visitorBook'];

                let count = goal['count'];

                $('#main').prop("checked", main);
                $('#personal').prop("checked", personal);
                $('#search-input').prop("checked", searchInput);
                $('#achievement').prop("checked", achievement);
                $('#visitorBook').prop("checked", visitorBook);

                progressbar.style.width = ((count / 5) * 100) + "%";
            });

        })

    </script>
</head>

<body>
    <div class="box0">
        <div class="box1" style="position:relative;">
            <div class="uppertext" style="position: absolute;">
                <p class="text1" style="display:inline">TODAY <span class="red">2002</span> | TOTAL 118</p>
                <p class="text2" style="display:inline; font-size: 30px; font-weight: 600;">I-world</p>
                <p class="text3" style="display:inline">ì°¸ê³ : https://www.cyworld.com</p>
                <div class="search-box">
                    <form class="d-flex search-form" role="search">
                        <a><img class="search-icon" src="./image/search-icon.png"></a>
                        <input id="search" class="form-control me-2" type="text" placeholder="Search"
                            aria-label="Search">
                    </form>
                </div>

            </div>
            <div class="box2">
                <p class="mood" style="font-size: 15px;">TODAY is í–‰ë³µğŸƒ</p>
                <div class="myimage">
                </div>
                <div class="introduce">
                    <p style="font-size: 14px;">íŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œíŒ€ì†Œê°œ</p>
                </div>
            </div>
            <div class="rings" style="position: absolute;">
                <div class="set1">
                    <div class="ring">
                    </div>
                    <div class="ring">
                    </div>
                </div>
                <div class="set2">
                    <div class="ring">
                    </div>
                    <div class="ring">
                    </div>
                </div>
            </div>
            <div class="box3">
                <div class="box4">
                    <div class="box5">
                        <h4 class="title">ìš°ë¦¬ íŒ€ë§Œì˜ íŠ¹ì§•</h4>
                        <hr>
                        <li>íŒ€ì›ë“¤ì´ ëª¨ë‘ Iì´ë‹¤.</li>
                        <li>ì‚¬ì „ìº í”„ë¥¼ ë¹ ì§ì—†ì´ ì™„ì£¼í•  ì •ë„ë¡œ ì„±ì‹¤í•˜ë‹¤.</li>
                        <li>ëª¨ë‘ ì½”ë”©ë„ì‚¬(ì§€ë§ìƒ)ë“¤ì´ë‹¤.</li>
                    </div>
                    <div class="box5">
                        <h4 class="title">ìš°ë¦¬ íŒ€ë§Œì˜ ì•½ì†</h4>
                        <hr>
                        <li>íŒ€ì› ê°„ì˜ ìƒí˜¸ ì¡´ì¤‘</li>
                        <li>íŒ€ì› ê°„ì˜ í˜¸ì¹­ '-ë‹˜'ìœ¼ë¡œ ë¶€ë¥´ê¸°</li>
                        <li>íšŒì˜ ì‹œê°„ ì¤€ìˆ˜í•˜ê¸°</li>
                    </div>
                </div>
                <div class="box6">
                    <h4 class="title">Our Goals</h4>
                    <hr>
                    <div class="goals">
                        <div class="checkbox">
                            <div class="with">
                                <form>
                                    <input class="checkbox" id="personal" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;ê°œì¸í˜ì´ì§€ ì™„ì„±<br>
                                    <input class="checkbox" id="main" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;ë©”ì¸í˜ì´ì§€ ì™„ì„±<br>
                                    <input class="checkbox" id="search-input" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;&nbsp;ê²€ìƒ‰ì°½
                                    ì´ìš©<br>
                                    <input class="checkbox" id="achievement" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;ë‹¬ì„±ë„ ìƒíƒœë°”ì— ë°˜ì˜<br>
                                    <input class="checkbox" id="visitorBook" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;ë°©ëª…ë¡ ì™„ì„±<br>
                                </form>
                            </div>

                        </div>
                        <div class="btn_ach" id="btn_ach">
                            <button id="sendbtn" class="send">ë°˜ì˜í•˜ê¸°</button><br>
                            <div class="progress" style="height: 10px;">
                                <div class="progress-bar" id="progressbar" role="progressbar" style="width: 0%"
                                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box7">
                    <h4 class="title">What friends say</h4>
                    <hr>
                    <p>ìµœì‹  ë°©ëª…ë¡</p>
                </div>
            </div>

            <div class="buttons" style="position: absolute;">
                <button id="index" class="index">í™ˆ</button>
                <button id="sunghun" class="sunghun">ê¹€ì„±í›ˆ</button>
                <button id="minsun" class="minsun">ê¹€ë¯¼ì„ </button>
                <button id="minah" class="minah">ìœ ë¯¼ì•„</button>
                <button id="yejin" class="yejin">ì´ì˜ˆì§„</button>
                <button id="visitor" class="visitor">ë°©ëª…ë¡</button>
            </div>
        </div>
    </div>

</body>

</html>