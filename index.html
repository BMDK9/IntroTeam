<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>λ©”μΈνμ΄μ§€</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pixelify+Sans&family=Single+Day&display=swap');

        * {
            font-family: 'Pixelify Sans', cursive;
            font-family: 'Single Day', cursive;
        }

        body {
            background-color: white;
        }

        .box0 {
            width: 1100px;
            height: 700px;
            background-color: #A6A6A6;
            background-image: url(image/yejin/β€”Pngtreeβ€”grid\ pattern.png);
            background-blend-mode: multiply;

            margin: 80px auto 0px auto;
            border-radius: 10px;

            display: flex;
        }

        .box1 {
            width: 1000px;
            height: 600px;
            background-color: #E0E0E0;

            margin: 40px auto 0px auto;
            border-radius: 10px;

            padding-top: 65px;
            padding-left: 35px;
            display: flex;
        }

        .uppertext {
            width: 930px;
            /* κ²€μƒ‰λ¶€λ¶„μΌλ΅ μΈν•΄ 800 -> 930 μΌλ΅ λ³€κ²½ν–μµλ‹λ‹¤ */
            height: 30px;
            margin-top: -40px;
        }

        .text1 {
            margin-left: 25px;
        }

        .red {
            color: #D60A0A;
        }

        .text2 {
            margin-left: 60px;
            color: #2980C9;
        }

        .text3 {
            margin-left: 40px;
        }

        .box2 {
            width: 200px;
            height: 500px;
            background-color: white;
            border: 1px solid black;
            margin-right: 30px;
        }

        .mood {
            width: 160px;
            height: 25px;
            margin: 10px auto 0px auto;
        }

        .myimage {
            width: 160px;
            height: 140px;
            background-image: url(image/logo.jpg);
            background-position: center;
            background-size: cover;

            margin: 0px auto 15px auto;
        }

        .introduce {
            width: 160px;
            height: 150px;
            margin: 0px auto 0px auto;

            border: 2px double;
            border-radius: 10px;

            padding: 7px;
        }

        .rings {
            margin-left: 190px;
            margin-top: 40px;
        }

        .set1 {
            margin-bottom: 200px;
        }

        .ring {
            width: 50px;
            height: 15px;
            background-color: #BEBEBE;
            border-radius: 30px;
            margin-bottom: 20px;
        }

        .box3 {
            width: 700px;
            height: 500px;
            background-color: white;
            border: 1px solid black;

            display: flex;
            flex-direction: column;
            text-align: center;
            justify-content: center;
        }

        .title {
            color: #2980C9;
        }

        .box4 {
            display: flex;
            flex-direction: row;
            text-align: center;
            justify-content: center;
        }

        hr {
            margin-bottom: 5px;
        }

        .box5 {
            width: 330px;
            height: 120px;
            text-align: left;
            margin: 20px 20px 0px 20px;
        }

        .box6 {
            width: 660px;
            height: 380px;
            text-align: left;
            margin: 20px 20px 0px 20px;
        }

        .goals {
            height: 200px;
            background-image: url('image/miniroom.gif');
            background-position: center;
            background-size: contain;

            display: flex;
            flex-direction: column;
            text-align: center;
            justify-content: center;

            margin-bottom: 10px;
        }

        .checkbox {
            margin-left: 40px;
            text-align: left;
            margin-top: 10px;
        }

        .btn_ach {
            width: 200px;
            margin: auto auto 0px auto;
        }

        .send {
            width: 100px;
            border: none;
            border-radius: 5px;
            ;
            margin-bottom: 10px;
            background-color: white;
        }

        .progress {
            width: 200px;
            margin-bottom: 20px;
            background-color: white;
        }

        .box7 {
            width: 660px;
            height: 200px;
            text-align: left;
            margin: 0px 20px 0px 20px;
        }

        .buttons {
            width: 100px;
            height: 320px;
            display: flex;
            flex-direction: column;

            margin-left: 930px;
        }

        .buttons>button {
            width: 100px;
            height: 50px;
            background-color: #5E5E5E;
            color: white;

            margin-bottom: 20px;

            border: none;
            border-radius: 5px;
            justify-content: center;
        }

        .search-box {
            display: inline-block;
            position: absolute;
            right: 0;
        }

        .search-form>a {
            border-radius: 5px 0px 0px 5px;
            padding: 7px;

            background-color: lightgray;
        }

        .search-icon {
            width: 20px;
            height: 20px;
        }

        .form-control {
            border-radius: 0px 5px 5px 0px;
        }

        .buttons>.index {
            background-color: rgb(153, 153, 153);
        }
    </style>

    <script type="module">
        // Firebase SDK λΌμ΄λΈλ¬λ¦¬ κ°€μ Έμ¤κΈ°
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { doc, collection, addDoc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase κµ¬μ„± μ •λ³΄ μ„¤μ •
        const firebaseConfig = {
            apiKey: "AIzaSyAzXX5j6y95F5-w-aemZc--QymtiWT_UVM",
            authDomain: "intro-team-42d34.firebaseapp.com",
            projectId: "intro-team-42d34",
            storageBucket: "intro-team-42d34.appspot.com",
            messagingSenderId: "367458824490",
            appId: "1:367458824490:web:b05f0947f7149006206e53",
            measurementId: "G-0488K83Q4K"
        };


        // Firebase μΈμ¤ν„΄μ¤ μ΄κΈ°ν™”
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);







        async function getSearchResult() { // κ²€μƒ‰ κ²°κ³Ό λ³΄μ—¬μ£Όλ” ν•¨μ
            searchWord = $('#search').val();

            if (searchWord == 'κΉ€μ„±ν›')
                location.href = 'sunghun.html'; // κΉ€μ„±ν›λ‹
            else if (searchWord == 'κΉ€λ―Όμ„ ')
                location.href = '2.html'; // κΉ€λ―Όμ„ λ‹
            else if (searchWord == 'μ λ―Όμ•„')
                location.href = 'minahpage.html'; // μ λ―Όμ•„
            else if (searchWord == 'μ΄μμ§„')
                location.href = 'yejinpage.html'; // μ΄μμ§„λ‹
            else
                alert(`${searchWord} μ— λ€ν• κ²€μƒ‰ κ²°κ³Όλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.`);
        }

        let searchWord = '';
        $('#search').keydown(function (e) { // enter λλ €μ„ λ• κ²€μƒ‰μ–΄ κ°€μ Έμ™€μ„ μ „λ‹¬
            if (e.keyCode == 13) {
                e.preventDefault();
                getSearchResult();
            }
        })

        $('#index').click(function () {
            location.href = 'index.html';
        })

        $('#minah').click(function () {
            location.href = 'minahpage.html';
        })

        $('#yejin').click(function () {
            location.href = 'yejinpage.html';
        })

        $('#sunghun').click(function () {
            location.href = 'sunghun.html';
        })

        async function dataUpdate() {
            let boxes = $("input[type='checkbox']:checked");
            let checked = boxes.length;

            let getId = $('#sendbtn').on('click', '.checkbox', function () {
                let boxId = $(this).attr('id');
            })

            let update = { // μ—…λ°μ΄νΈν•  λ°μ΄ν„°
                'main': $(`#main`).is(':checked'),
                'personal': $('#personal').is(':checked'),
                'search': $(`#search-input`).is(':checked'),
                'achievement': $(`#achievement`).is(':checked'),
                'visitorBook': $(`#visitorBook`).is(':checked'),

                'count': checked
            };

            let dataPackage = await getDocs(collection(db, "goals"));
            dataPackage.forEach(async (data) => {
                console.log(data.id, update);
                await updateDoc(doc(db, "goals", data.id), update);
                window.location.reload();
            })
        }

        $('#sendbtn').click(async function () {
            dataUpdate();
        });


        $(document).ready(async function () {
            let getData = await getDocs(collection(db, "goals"));
            getData.forEach((doc) => {
                console.log("Current data: ", doc.data());
                let goal = doc.data();

                let main = goal['main'];
                let personal = goal['personal'];
                let searchInput = goal['search'];
                let achievement = goal['achievement'];
                let visitorBook = goal['visitorBook'];
                let count = goal['count'];



                $('#main').prop("checked", main);
                $('#personal').prop("checked", personal);
                $('#search-input').prop("checked", searchInput);
                $('#achievement').prop("checked", achievement);
                $('#visitorBook').prop("checked", visitorBook);

                progressbar.style.width = ((count / 5) * 100) + "%";
            });

        })

        $(document).ready(async function () {
            let getData = await getDocs(collection(db, "logs"));
            let temp = ``;
            getData.forEach((doc) => {
                let log = doc.data();

                let content = log['content'];
                let date = log['date'];

                let update = {
                'content': $(`#content`),
                'date': $('#date')
                };

                temp = `<p>${content} ( Date: ${date} )</p>`;
            });

            $('#visit-comment').append(temp);
        })

    </script>
</head>

<body>
    <div class="box0">
        <div class="box1" style="position:relative;">
            <div class="uppertext" style="position: absolute;">
                <p class="text1" style="display:inline">TODAY <span class="red">2002</span> | TOTAL 118</p>
                <p class="text2" style="display:inline; font-size: 30px; font-weight: 600;">I-world</p>
                <p class="text3" style="display:inline">μ°Έκ³ : https://www.cyworld.com</p>
                <div class="search-box">
                    <form class="d-flex search-form" role="search">
                        <a><img class="search-icon" src="./image/search-icon.png"></a>
                        <input id="search" class="form-control me-2" type="search" placeholder="Search"
                            aria-label="Search">
                    </form>
                </div>

            </div>
            <div class="box2">
                <p class="mood" style="font-size: 15px;">TODAY is ν–‰λ³µπƒ</p>
                <div class="myimage">
                </div>
                <div class="introduce">
                    <p style="font-size: 14px;">ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°ν€μ†κ°</p>
                </div>
            </div>
            <div class="rings" style="position: absolute;">
                <div class="set1">
                    <div class="ring">
                    </div>
                    <div class="ring">
                    </div>
                </div>
                <div class="set2">
                    <div class="ring">
                    </div>
                    <div class="ring">
                    </div>
                </div>
            </div>
            <div class="box3">
                <div class="box4">
                    <div class="box5">
                        <h4 class="title">μ°λ¦¬ ν€λ§μ νΉμ§•</h4>
                        <hr>
                        <li>ν€μ›λ“¤μ΄ λ¨λ‘ Iμ΄λ‹¤.</li>
                        <li>μ‚¬μ „μΊ ν”„λ¥Ό λΉ μ§μ—†μ΄ μ™„μ£Όν•  μ •λ„λ΅ μ„±μ‹¤ν•λ‹¤.</li>
                        <li>λ¨λ‘ μ½”λ”©λ„μ‚¬(μ§€λ§μƒ)λ“¤μ΄λ‹¤.</li>
                    </div>
                    <div class="box5">
                        <h4 class="title">μ°λ¦¬ ν€λ§μ μ•½μ†</h4>
                        <hr>
                        <li>ν€μ› κ°„μ μƒνΈ μ΅΄μ¤‘</li>
                        <li>ν€μ› κ°„μ νΈμΉ­ '-λ‹'μΌλ΅ λ¶€λ¥΄κΈ°</li>
                        <li>νμ μ‹κ°„ μ¤€μν•κΈ°</li>
                    </div>
                </div>
                <div class="box6">
                    <h4 class="title">Our Goals</h4>
                    <hr>
                    <div class="goals">
                        <div class="checkbox">
                            <div class="with">
                                <form>
                                    <input class="checkbox" id="personal" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;κ°μΈνμ΄μ§€ μ™„μ„±<br>
                                    <input class="checkbox" id="main" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;λ©”μΈνμ΄μ§€ μ™„μ„±<br>
                                    <input class="checkbox" id="search-input" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;&nbsp;κ²€μƒ‰μ°½
                                    μ΄μ©<br>
                                    <input class="checkbox" id="achievement" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;λ‹¬μ„±λ„ μƒνƒλ°”μ— λ°μ<br>
                                    <input class="checkbox" id="visitorBook" type="checkbox"
                                        style="margin-left: 2.5%;">&nbsp;λ°©λ…λ΅ μ™„μ„±<br>
                                </form>
                            </div>

                        </div>
                        <div class="btn_ach" id="btn_ach">
                            <button id="sendbtn" class="send">λ°μν•κΈ°</button><br>
                            <div class="progress" style="height: 10px;">
                                <div class="progress-bar" id="progressbar" role="progressbar" style="width: 0%"
                                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="box7" id="visit-comment">
                    <h4 class="title">What friends say</h4>
                    <hr>

                </div>
            </div>
            <div class="buttons" style="position: absolute;">
                <button id="index" class="index">ν™</button>
                <button id="sunghun" class="sunghun">κΉ€μ„±ν›</button>
                <button>κΉ€λ―Όμ„ </button>
                <button id="minah" class="minah">μ λ―Όμ•„</button>
                <button id="yejin" class="yejin">μ΄μμ§„</button>
                <button>λ°©λ…λ΅</button>
            </div>
        </div>
    </div>

</body>

</html>